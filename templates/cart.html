<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Cart — {{ m.business_name }}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --bg:#0b0f17; --card:#0f1728; --line:#1f2a44; --txt:#e8f0ff; --muted:#bcd0ff; --brand:#6e9fff;
    }
    .cw-blue  { --brand:#6e9fff; }
    .cw-mint  { --brand:#5ad49e; }
    .cw-purple{ --brand:#a88cff; }
    .cw-amber { --brand:#ffb86b; }
    .light { --bg:#f6f7fb; --card:#ffffff; --line:#e6e8f0; --txt:#0b0f17; --muted:#4b587c; }

    body{
      font-family: {{ m.font_family or 'Arial,Helvetica,sans-serif' }};
      background:var(--bg); color:var(--txt); margin:0
    }
    .wrap{max-width:820px;margin:0 auto;padding:20px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px;margin-bottom:16px}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .item{display:flex;gap:12px;align-items:center;border-top:1px solid var(--line);padding:10px 0}
    .item img{width:56px;height:56px;object-fit:cover;border-radius:8px;border:1px solid var(--line);background:#0c1424}
    .muted{color:var(--muted)}
    .btn{
      background:var(--brand); color:#0b0f17; border:0; border-radius:10px;
      padding:10px 12px; font-weight:800; cursor:pointer; text-decoration:none; display:inline-block
    }
    form{display:inline}
  </style>
</head>
{% set cw = m.colorway if m and m.colorway else 'cw-blue' %}
<body class="{{ cw }} {% if m.theme_mode=='light' %}light{% endif %}">
<div class="wrap">
  <div class="card">
    <div class="row" style="justify-content:space-between">
      <div style="font-weight:800">{{ m.business_name }} — Cart</div>
      <div>
        <a class="btn" href="/store/{{ m.slug }}?{% if t %}t={{ t }}&{% endif %}cid={{ cid }}">Continue shopping</a>
      </div>
    </div>
    {% if rows|length == 0 %}
      <p class="muted">Your cart is empty.</p>
    {% else %}
      {% for r in rows %}
        <div class="item">
          {% if r.image_url %}
            <img src="/uimg?src={{ r.image_url | urlencode }}" alt="">
          {% else %}
            <img src="/uimg" alt="">
          {% endif %}
          <div style="flex:1">
            <div style="font-weight:700">{{ r.title }}</div>
            <div class="muted">
              {{ '%.7f'|format(r.pi_price) }} Pi × {{ r.qty }}
              {# Optional: show line subtotal #}
              <!-- • {{ '%.7f'|format((r.pi_price or 0.0) * (r.qty or 1)) }} Pi -->
            </div>
          </div>
          <form method="post" action="/cart/{{ cid }}/remove">
            {% if t %}<input type="hidden" name="t" value="{{ t }}">{% endif %}
            <input type="hidden" name="row_id" value="{{ r.cid }}">
            <button class="btn" type="submit">Remove</button>
          </form>
        </div>
      {% endfor %}
      <div class="row" style="justify-content:flex-end;margin-top:10px">
        <div style="font-size:18px;font-weight:800">Total: {{ '%.7f'|format(total) }} Pi</div>
      </div>
      <div class="row" style="justify-content:flex-end;margin-top:10px">
        <a class="btn" href="/checkout/cart/{{ cid }}?{% if t %}t={{ t }}{% endif %}">Proceed to Checkout</a>
      </div>
    {% endif %}
  </div>
</div>
</body>
</html>
